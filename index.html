<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Scan Sender (CE Compatible)</title>
<style>
body { font-family: Tahoma; font-size: 16px; background: #eef; margin: 10px; }
input { font-size: 22px; width: 95%; padding: 8px; }
#status { margin-top: 8px; color: #003366; font-size: 14px; }
</style>
</head>
<body>
<h3>Scan to Send</h3>
<input id="scan" placeholder="Scan here..." />
<div id="status">Ready...</div>

<script>
(function(){
  var host = "192.168.1.103";  // عدّل IP السيرفر هنا
  var port = 9999;             // عدّل البورت هنا
  var scan = document.getElementById("scan");
  var status = document.getElementById("status");
  var lastValue = "";

  function send(val){
    if(!val) return;
    try {
      var img = new Image();
      img.src = "http://" + host + ":" + port + "/?scan=" + escape(val) + "&_=" + (new Date()).getTime();
      status.innerText = "Sent: " + val;
      scan.value = "";
    } catch(e){
      status.innerText = "Error sending: " + e.message;
    }
  }

  // طريقة بدائية جداً لمتصفحات CE القديمة
  function checkLoop(){
    var v = scan.value;
    if(v && v != lastValue){
      lastValue = v;
      send(v);
    }
    setTimeout(checkLoop, 300); // فحص كل 0.3 ثانية
  }

  checkLoop();
  try { scan.focus(); } catch(e){}
})();
</script>
</body>
</html>
