<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Scan Sender CE - VBScript</title>
<style>
body { font-family:Tahoma; font-size:14px; text-align:center; background-color:#eef; }
input { font-size:20px; width:300px; margin:10px; }
button { font-size:16px; padding:6px 12px; }
#status { margin-top:10px; color:#003366; font-size:12px; }
</style>
</head>
<body>

<h3>Scan Sender CE (VBScript)</h3>
<p>ضع المؤشر في المربع ثم اعمل Scan</p>
<input type="text" id="scan" />
<br>
<button onclick="SendNow">إرسال يدوي</button>
<div id="status">جاهز</div>

<script language="VBScript">
Dim ws, lastValue
Set ws = CreateObject("MSWinsock.Winsock")

Sub SendNow()
    Dim txt, host, port
    host = "192.168.1.103"   ' <-- عدّل هنا IP الكمبيوتر
    port = 9999             ' <-- وعدّل البورت حسب الـ listener
    txt = Document.All("scan").Value
    If txt = "" Then
        Document.All("status").innerText = "لا يوجد شيء للإرسال."
        Exit Sub
    End If
    On Error Resume Next
    ws.RemoteHost = host
    ws.RemotePort = port
    ws.Connect
    WScript.Sleep 500
    ws.SendData txt
    ws.Close
    Document.All("status").innerText = "تم إرسال: " & txt & " إلى " & host & ":" & port
    Document.All("scan").Value = ""
End Sub

Sub Window_OnLoad()
    Document.All("scan").Focus
End Sub
</script>

</body>
</html>
